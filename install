#!/usr/bin/env python3
#--*-- coding: utf-8 --*--


"""
install script for ethOS-update-manager
chmod exec for launch.py and main.py
create aliases and cmd for autoclaunch in .bashrc with fancy text
try to reboot 
"""

# import 
import os, time


# prepare sys
os.system("cd /home/ethos/")
os.system("chmod +x /home/ethos/ethOS-update-manager/launch.py")
os.system("chmod +x /home/ethos/ethOS-update-manager/src/main.py")


# title in .bashrc
os.system("""echo ' ' >> /home/ethos/.bashrc """)
os.system("""echo ' ' >> /home/ethos/.bashrc """)
os.system("""echo '##################################' >> /home/ethos/.bashrc """)
os.system("""echo '#	ethOS-update-manager' >> /home/ethos/.bashrc """)
os.system("""echo '##################################' >> /home/ethos/.bashrc """)


# one blanck line
os.system("""echo ' ' >> /home/ethos/.bashrc """)


# create alias (shortcup for CLI) 'LAUNCH' to launch program manualy : 
os.system("""echo '# create alias (shortcup for CLI) 'LAUNCH' to launch program manualy :' >> /home/ethos/.bashrc """)
os.system("""echo "alias LAUNCH='python3 /home/ethos/ethOS-update-manager/launch.py'" >> /home/ethos/.bashrc """)


# one blanck line
os.system("""echo ' ' >> /home/ethos/.bashrc """)


# for automatic program launch (background) at each ethos stratup :
os.system("""echo '# for automatic program launch (background) at each ethos stratup:' >> /home/ethos/.bashrc """)
os.system("""echo 'python3 /home/ethos/ethOS-update-manager/launch.py' >> /home/ethos/.bashrc """)


# info reboot
print(	"\n\n"
		"######################################################\n"
		"######################################################\n\n\n"
		"-->  your program is now installed and functional <--\n\n\n"
		"-->   for full install, system will reboot in 3s  <--\n\n\n"
		"######################################################\n"
		"######################################################\n"
		"\n\n")

time.sleep(1)
print()
for i in range(4, 0, -1) : 
	print(str(i-1))
	time.sleep(1)


#auto reboot 
ans = os.system("r")
if ans : 
	ans = os.system("reboot")
	if ans : 
		ans = os.system("sudo reboot")
		if ans : 
			print(	"\n\n"
					"##################################################\n"
					"##################################################\n\n\n"
					"-->  auto reboot fail : please reboot manualy  <--\n\n\n"
					"##################################################\n"
					"##################################################\n"
					"\n\n")